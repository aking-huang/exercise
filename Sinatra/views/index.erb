<%# encoding:utf-8 %>
<!DOCTYPE html>
<html lang="zh-ch">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Rule Test System</title>

  <!-- Bootstrap core CSS -->
  <link href="/css/bootstrap.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <!-- link href="/css/jumbotron.css" rel="stylesheet" -->

  <!-- Just for debugging purposes. Don't actually copy this line! -->
  <!--[if lt IE 9]><![endif]-->
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
  <![endif]-->
</head>

<body>

<div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">应用识别</a>
    </div>
    <div class="navbar-collapse collapse">
      <form class="navbar-form navbar-right" role="form">
        <div class="form-group">
          <input type="text" placeholder="Email" class="form-control">
        </div>
        <div class="form-group">
          <input type="password" placeholder="Password" class="form-control">
        </div>
        <button type="submit" class="btn btn-success">Sign in</button>
      </form>
    </div><!--/.navbar-collapse -->
  </div>
</div>

<!-- Main jumbotron for a primary marketing message or call to action -->
<div class="jumbotron">
  <div class="container">
    <h2>应用识别测试系统</h2>
    <p>该系统首先进行数据分包，基于单连接的数据包经过识别系统后，得到相应结果。This is a template for a simple marketing or informational website. It includes a large callout called a jumbotron and three supporting pieces of content. Use it as a starting point to create something more unique.</p>

    <p><a class="btn btn-primary btn-lg" role="button">Learn more &raquo;</a></p>
  </div>
</div>

<div class="container">
  <!-- Example row of columns -->
  <div class="row">
    <div class="col-md-4">
      <h3>数据分流与识别</h3>
      <p>数据流：基于应用层协议识别的对象不能只是简单的检查单个报文，而是要将数据流作为一个整体来检测。因此，数据流是指在某个会话生命周期内，通过网络上一个检测节点的IP数据报文的集合。实际上，一个节点发送的数据流的所有属性是相同的。</p>
      <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
    </div>
    <div class="col-md-4">
      <h3>数据分析与管理</h3>
      <p>数据流分类：利用数据流以及数据流中报文的某些信息，可将网络上的数据流进行分类，这种分类可加速应用流量的分类，如游戏应用数据流通常是小报文，而P2P流一般称为大报文。将分流识别后的数据包进行分析管理，便于后续维护。</p>
      <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
    </div>
    <div class="col-md-4">
      <h3>数据筛选与测试</h3>
      <p>数据流类别：数据流类别是一个大型网状结构的分类器，按照行为特征及签名进行归类。在数据流分类问题中，每个类别可能包含某些属性类似的多种协议，典型的如IE下载即包括了多个类别，有分块下载，有伪IE下载等，有另存单线程下载等。</p>
      <p><a class="btn btn-default" href="#" role="button">View details &raquo;</a></p>
    </div>
  </div>
</div> <!-- /container -->

<div class="container">
  <div class="page-header">
    <h3>最新数据</h3>
  </div>

  <div class="input-append">
    <input type="text" class="span2 search-query">
    <button type="submit" class="btn">Search</button>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered">
      <tr class="active">
        <td><B>pcap</B></td>
        <td><B>proto</B></td>
        <td><B>app_name</B></td>
        <td><B>rule_name</B></td>
        <td><B>version</B></td>
        <td><B>action</B></td>
        <td><B>os</B></td>
        <td><B>browser</B></td>
      </tr>
      
      <% @info.each_index do |index| %>
        <% if (index%2) == 1 %>
          <tr class="active">
        <% else %>
          <tr class="success">
        <% end %>

          <td><%= @info[index].pcap %></td>
          <% if @info[index].proto == 6 %>
            <td>TCP</td>
          <% elsif @info[index].proto == 17 %>
            <td>UDP</td>
          <% elsif @info[index].proto == 80 %>
            <td>HTTP</td>
          <% else %>
            <td>All</td>
          <% end %>

          <td><%= @info[index].app_name %></td>
          <td><%= @info[index].rule_name %></td>
          <td><%= @info[index].appversion %></td>
          <td><%= @info[index].action %></td>
          <td><%= @info[index].os %></td>
          <td><%= @info[index].browser %></td>
        </tr>
      <% end %>      
      
    </table>
  </div>

  <div class="page-header">
    <h3>常见应用</h3>
  </div>
  <div class="progress">
    <div class="progress-bar" style="width: 5%"><strong>IM</strong></div>
    <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 80%"><strong>2000</strong></div>
  </div>
  <div class="progress">
    <div class="progress-bar" style="width: 5%"><strong>P2P</strong></div>
    <div class="progress-bar progress-bar-info" role="progressbar" aria-valuenow="20" aria-valuemin="0" aria-valuemax="100" style="width: 60%"><strong>1400</strong></div>
  </div>
  <div class="progress">
    <div class="progress-bar" style="width: 5%"><strong>QQ</strong></div>
    <div class="progress-bar progress-bar-warning" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 40%"><strong>1000</strong></div>
  </div>
  <div class="progress">
    <div class="progress-bar" style="width: 5%"><strong>FTP</strong></div>
    <div class="progress-bar progress-bar-danger" role="progressbar" aria-valuenow="80" aria-valuemin="0" aria-valuemax="100" style="width: 20%"><strong>400</strong></div>
  </div>


  <hr>
  <footer>
    <p>&copy; Company 2014</p>
  </footer>
</div>

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="/js/bootstrap.min.js"></script>
</body>
</html>
